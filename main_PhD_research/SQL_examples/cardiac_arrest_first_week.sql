DROP TABLE IF EXISTS mimic_derived.cardiac_first_day; CREATE TABLE mimic_derived.cardiac_first_day AS
SELECT
	cardiac_arrest.subject_id ,
	icustay_detail.stay_id,
    -- Demographics, admission and discharge info, and outcomes
	hadm_id ,
	gender ,
	dod ,
	admittime ,
	dischtime ,
	los_hospital ,
	admission_age ,
	ethnicity ,
	hospital_expire_flag ,
	hospstay_seq ,
	first_hosp_stay ,
	icu_intime ,
	icu_outtime ,
	los_icu ,
	icustay_seq ,
	first_icu_stay ,
    -- Lab values for first day
	hematocrit_min  ,
	hematocrit_max  ,
	hemoglobin_min  ,
	hemoglobin_max  ,
	platelets_min  ,
	platelets_max  ,
	wbc_min  ,
	wbc_max  ,
	albumin_min  ,
	albumin_max  ,
	globulin_min  ,
	globulin_max  ,
	total_protein_min  ,
	total_protein_max  ,
	aniongap_min  ,
	aniongap_max  ,
	bicarbonate_min  ,
	bicarbonate_max  ,
	bun_min  ,
	bun_max  ,
	calcium_min  ,
	calcium_max  ,
	chloride_min  ,
	chloride_max  ,
	creatinine_min  ,
	creatinine_max  ,
	sodium_min  ,
	sodium_max  ,
	potassium_min  ,
	potassium_max  ,
	abs_basophils_min ,
	abs_basophils_max ,
	abs_eosinophils_min ,
	abs_eosinophils_max ,
	abs_lymphocytes_min ,
	abs_lymphocytes_max ,
	abs_monocytes_min ,
	abs_monocytes_max ,
	abs_neutrophils_min ,
	abs_neutrophils_max ,
	atyps_min  ,
	atyps_max  ,
	bands_min  ,
	bands_max  ,
	imm_granulocytes_min  ,
	imm_granulocytes_max  ,
	metas_min  ,
	metas_max  ,
	nrbc_min  ,
	nrbc_max  ,
	d_dimer_min  ,
	d_dimer_max  ,
	fibrinogen_min  ,
	fibrinogen_max  ,
	thrombin_min  ,
	thrombin_max  ,
	inr_min  ,
	inr_max  ,
	pt_min  ,
	pt_max  ,
	ptt_min  ,
	ptt_max  ,
	alt_min  ,
	alt_max  ,
	alp_min  ,
	alp_max  ,
	ast_min  ,
	ast_max  ,
	amylase_min  ,
	amylase_max  ,
	bilirubin_total_min  ,
	bilirubin_total_max  ,
	bilirubin_direct_min  ,
	bilirubin_direct_max  ,
	bilirubin_indirect_min  ,
	bilirubin_indirect_max  ,
	ck_cpk_min  ,
	ck_cpk_max  ,
	ck_mb_min  ,
	ck_mb_max  ,
	ggt_min  ,
	ggt_max  ,
	ld_ldh_min  ,
	ld_ldh_max  ,
    -- vitals for first day
	heart_rate_min  ,
	heart_rate_max  ,
	heart_rate_mean  ,
	sbp_min  ,
	sbp_max  ,
	sbp_mean  ,
	dbp_min  ,
	dbp_max  ,
	dbp_mean  ,
	mbp_min  ,
	mbp_max  ,
	mbp_mean  ,
	resp_rate_min  ,
	resp_rate_max  ,
	resp_rate_mean  ,
	temperature_min ,
	temperature_max ,
	temperature_mean ,
	spo2_min  ,
	spo2_max  ,
	spo2_mean  ,
	first_day_vitalsign.glucose_min  ,
	first_day_vitalsign.glucose_max  ,
	first_day_vitalsign.glucose_mean

FROM mimic_derived.cardiac_arrest
INNER JOIN mimic_derived.icustay_detail ON cardiac_arrest.subject_id = icustay_detail.subject_id
INNER JOIN mimic_derived.first_week_lab ON icustay_detail.stay_id = first_week_lab.stay_id
INNER JOIN mimic_derived.first_day_vitalsign ON icustay_detail.stay_id = first_day_vitalsign.stay_id
ORDER BY subject_id, stay_id